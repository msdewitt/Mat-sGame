"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const _1 = require("./");
const core_1 = require("../core");
class FactoryContainer extends _1.Container {
    constructor(stereotype, type, dependencies, name) {
        super(stereotype, dependencies, name);
        this._type = type;
        this._children = [];
    }
    get type() {
        return this._type;
    }
    addChild(child) {
        this._children.push(child);
    }
    resolveDepedendencies() {
        function _resolveInstances(name) {
            let data = _1.ClassContainer.getDependency(name);
            return (data.stereotype == core_1.Stereotype.Singleton)
                ? data.instance
                : data.resolveDepedendencies();
        }
        function _resolveHelper(dependencies, resolved) {
            if (dependencies.length == 0)
                return;
            let _current = dependencies.pop();
            _current.resolved = _resolveInstances(_current.container.name);
            resolved.push(_current);
            return _resolveHelper(dependencies, resolved);
        }
        _resolveHelper(this.dependencies, this._resolved);
        this._instance = (this._children.length != 0)
            ? this._children[this._children.length - 1]
            : this._type;
        _1.ClassContainer.insertDependency(this.name, this);
        _1.ClassContainer.insertParent(this.name, this);
        return this._instance;
    }
    get instance() {
        return this._instance || (this._instance = this._children[this._children.length - 1]);
    }
}
exports.FactoryContainer = FactoryContainer;
//# sourceMappingURL=factory-container.js.map